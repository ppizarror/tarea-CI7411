\newpage
\section{Pregunta 2}

\textbf{Implemente las ecuaciones de propagación unidimensional de ondas de corte para un medio visco-elástico compuesto por capas en condición permanente y grafique el desplazamiento de partícula en profundidad en forma animada. Considere un depósito compuesto por tres capas.} \\

\subsectionanum{Teoría}

Considérese un depósito de suelo conformado por capas perfectamente horizontales y de extensión infinita, tal como se indica en la Figura \ref{p2capasteoria}:

\insertimage[\label{p2capasteoria}]{p2capasteoria}{width=8cm}{Depósito de sueos conformado por capas horizontales.}

Al igual que el caso anterior, al realizar equilibrio dinámico sobre un elemento diferencial sometido a corte se obtiene nuevamente la siguiente ecuación de equilibrio:

\insertequation{\fracpartial{\tau}{z} = \rho \cdot \fracdpartial{u}{t}}

Considerando un modelo constitutivo visco-elástico de tipo Kelvin-Voigt \footnote{El cual considera un sistema en paralelo de disipador y resorte.}:

\insertequation{\tau = G \gamma + c \cdot \dot{\gamma}}
\insertequation{\begin{array}{ccc}
		\fracpartial{\tau}{z} = G \fracpartial{\gamma}{z} + c \frac{\partial^2 \gamma}{\partial t \partial z} & & \fracpartial{\tau}{z} = G \fracdpartial{u}{z} + c \frac{\partial^3 u}{\partial t \partial z^2}
	\end{array}
}

Se concluye que $\rho \fracdpartial{u}{t} = G \fracdpartial{u}{z} + c \frac{\partial^3 u}{\partial t \partial z^2}$, luego suponiendo una solución general del tipo $u(z,t)=U(z)e^{i\omega t}$:

\insertequationanum{-\rho \cdot U(z)\omega^2 e^{i\omega t} = G \cdot\fracdpartial{U}{z} e^{i\omega t} + i \omega c \cdot\fracdpartial{U}{z} e^{i\omega t}}

\insertequation[\label{p2uedp}]{-\rho U(z)\cdot \omega^2 = (G+i\omega c)\cdot \fracdpartial{U}{z}}

La ecuación \eqref{p2uedp} es análoga a la que se obtiene para un suelo elástico. Definiendo luego el módulo de corte complejo como:

\insertequation{G^* = G + i\omega c}

Se tiene la misma forma que la ecuación de onda elástica:

\insertequation{G^* \fracdpartial{U}{z} = -\rho U(z) \cdot \omega^2}

Si se escoge $c = \frac{2GD}{\omega}$, en donde $D$ corresponde al coeficiente de \textit{Damping} del suelo, se tiene que:

\insertequation{G^{*} = G \cdot \bigg(1+2iD\bigg)}

En el caso particular de esta tarea se utilizó el valor de la velocidad de onda de corte para cada capa de suelo (dado que es un valor más intuitivo y cercano a la práctica profesional que el valor de G), por tanto, utilizando la relación \eqref{Grhovs} entre la densidad, velocidad y módulo de cizalle, se tiene:

\insertequation{\text{Velocidad de onda compleja:}\quad V_s^* = \sqrt{\frac{G^*}{\rho}} = V_s \cdot \sqrt{1+2iD}}

\insertequation{\text{Número de onda complejo:}\quad k^* = \frac{\omega}{V_s} = \frac{\omega}{V_s \cdot \sqrt{1+2iD}}}

Una solución de la ecuación de movimiento que considera el modelo viscoelástico es:

\insertequation{u(z,t) = E\cdot e^{i\big(\omega t + k^*z\big)}+F\cdot e^{i\big(\omega t +- k^*z\big)}}

La ecuación para cada j-capa:

\insertequation[\label{p2eqcapa}]{\boxed{u_j(z_j,t) = E_j\cdot e^{i\big(\omega t + k_j^*z\big)}+F_j\cdot e^{i\big(\omega t +- k_j^*z\big)}}}

En el contacto entre la capa $j$ y $j+1$ se debe satisfacer:

\begin{enumeratebf}
	\item \textbf{Compatibilidad de desplazamientos:} $u_j(z_j=H_j) = u_{j+1}(z_{j+1}=0)$
	\item \textbf{Compatibilidad de esfuerzos:} $\tau_j(z_j=H_j) = \tau_{j+1}(z_{j+1}=0)$
\end{enumeratebf}

Lo que se traduce en:

\begin{enumeratebf}
	\item $E_j\cdot e^{\big(\omega t + k_j^* H_j\big)} + F_j\cdot e^{\big(\omega t - k_j^* H_j\big)} = E_{j+1}\cdot e^{i\omega t} + F_{j+1}\cdot e^{i\omega t}$
	\insertequation[\label{p2rel1}]{E_j\cdot e^{ik_j^*H_j}+F_j\cdot e^{-ik_j^*H_j} = E_{j+1}+F_{j+1}}
	
	\item $\tau_j = G_j\bigg(\fracpartial{u_j}{z_j}\bigg)+c_j\bigg(\frac{\partial^2 u_j}{\partial t \partial z}\bigg)$ \\
	$\fracpartial{u_j}{z_j} = E_j \cdot i \cdot k_j^* \cdot e^{i\big(\omega t  + k_j^* z_j\big)} - F_j \cdot i \cdot k_j^* \cdot e^{i\big(\omega t - k_j^*z_j\big)}$ \\
	$\frac{\partial}{\partial t}\bigg(\fracpartial{u_j}{z_j}\bigg) = -E_j \cdot k_j^* \cdot \omega \cdot e^{i\big(\omega t + k_j^* z_j\big)}+F_j \cdot k_j^* \cdot \omega \cdot e^{i\big(\omega t - k_j^* z_j\big)}$ \\
	
	Así: \\
	$\tau_j = G_j \cdot \bigg[E_j \cdot i \cdot k_j^* \cdot e^{i\big(\omega t  + k_j^* z_j\big)} - F_j \cdot i \cdot k_j^* \cdot e^{i\big(\omega t - k_j^*z_j\big)}\bigg] + c_j \cdot \bigg[-E_j \cdot k_j^* \cdot \omega \cdot e^{i\big(\omega t + k_j^* z_j\big)}+F_j \cdot k_j^* \cdot \omega \cdot e^{i\big(\omega t - k_j^* z_j\big)}\bigg]$ \\
	
	Finalmente: \\
	$\tau_j = \big(G_j + i \cdot c_j \cdot \omega \big) \cdot \big(E_j \cdot e^{i k_j^* z_j}-F_j \cdot e^{-i k_j^* z_j}\big) \cdot i \cdot k_j^* \cdot e^{i\omega t}$
\end{enumeratebf}

Por lo tanto, la compatibilidad de esfuerzos se traduce en:

\insertequation{\big(G_j + i \cdot c_j \cdot \omega \big) \cdot \big(E_j \cdot e^{i k_j^* z_j}-F_j \cdot e^{-i k_j^* z_j}\big) \cdot k_j^* = \big(G_{j+1} + i \cdot c_{j+1} \cdot \omega \big) \cdot \big(E_{j+1} - F_{j+1}\big)\cdot k_{j+1}^*}

\insertequation[\label{p2rel2}]{\Rightarrow E_{j+1} - F_{j+1} = \big(E_j \cdot e^{i k_j^* z_j}-F_j \cdot e^{-i k_j^* z_j}\big) \cdot \frac{\big(G_j + i \cdot c_j \cdot \omega \big)}{\big(G_{j+1} + i \cdot c_{j+1} \cdot \omega \big)} \cdot \frac{k_{j}^*}{k_{j+1}^*}} \\

Se define la impedancia compleja como:

\insertequation{\Delta_j =  \frac{\big(G_j + i \cdot c_j \cdot \omega \big)}{\big(G_{j+1} + i \cdot c_{j+1} \cdot \omega \big)} \cdot \frac{k_{j}^*}{k_{j+1}^*} = \frac{\rho_j \cdot Vs_j}{\rho_{j+1} \cdot Vs_{j+1}} \cdot \sqrt{\frac{1+2iD_j}{1+2iD_{j+1}}}} \\

Luego, utilizando las relaciones \eqref{p2rel1} y \eqref{p2rel2} se tiene que:

\insertequation{\begin{array}{c}
		E_{j+1} = \frac{1}{2} \bigg[E_j \big(1+\Delta_j\big)\cdot e^{i k_j^* H_j} + F_j \big(1-\Delta_j\big) \cdot e^{-ik_j^*H_j}\bigg] \\
		F_{j+1} = \frac{1}{2} \bigg[E_j \big(1-\Delta_j\big)\cdot e^{i k_j^* H_j} + F_j \big(1+\Delta_j\big) \cdot e^{-ik_j^*H_j}\bigg]
	\end{array}
}

Al igual que la pregunta 1, al aplicar la condición de superficie libre se tiene que, en $z_1=0 \rightarrow \tau=0$, por tanto, al derivar \eqref{p2eqcapa} en la primera capa, e igual a cero, se obtiene que $E_1 = F_j$.

\subsectionanum{Implementación en Matlab}

Para resolver el problema se creó, al igual que para la primera pregunta, una función que, al recibir los parámetros del suelo para cada capa (densidad, velocidad de corte, altura de capa), el período de la onda y un valor inicial para $E_1$ retorna una función $u(z,t)$ que permite evaluar el desplazamiento en cualquier punto. \\

A continuación se muestra el extracto de código más importante de la implementación:

\newpage
\begin{sourcecodep}{matlab}{firstnumber=52}{Código más importante de \texttt{u\_velt.m}.}
%% Calcula propiedades N capas (Kelvin-Voigt)
nVs = Vs .* sqrt(1+2*1i*D); % Velocidad onda de corte compleja (si D!=0)
nG = nVs .* nVs .* rho; %#ok<NASGU> % Modulo de corte complejo (si D!=0)
w = 2 * pi / T; % Frecuencia
k = w ./ nVs; % Numero de onda complejo (si D!=0)

%% Calcula el vector de impedancias
imp = zeros(n-1, 1);
for i = 1:(n - 1)
    imp(i) = (rho(i) * nVs(i)) / (rho(i+1) * nVs(i+1));
end

%% Calcula los coeficientes E, F
E = zeros(n, 1);
F = zeros(n, 1);
E(1) = E1;
F(1) = E1; % Por condicion de superficie libre
for j = 1:(n - 1)
    E(j+1) = 0.5 * (E(j) * (1 + imp(j)) * exp(1i*k(j)*H(j)) + F(j) * (1 - imp(j)) * exp(-1i*k(j)*H(j)));
    F(j+1) = 0.5 * (E(j) * (1 - imp(j)) * exp(1i*k(j)*H(j)) + F(j) * (1 + imp(j)) * exp(-1i*k(j)*H(j)));
end

%% Calcula las alturas acumuladas
Hacum = zeros(n-1, 1);
Hacum(1) = H(1);
for j = 2:(n - 1)
    Hacum(j) = Hacum(j-1) + H(j);
end

%% Retorna la funcion de desplazamiento
u = @(z, t) u_zt_nc_velt(z, t, n, Hacum, E, F, k, w);
\end{sourcecodep}

Al evaluar $u(z,t)$ se llama a la función privada \texttt{u\_zt\_nc\_velt} la cual comprobará a qué capa pertenece un $z$ variable, utiliza luego los $E_j$ y $F_j$ de dicha capa (considerando siempre $z_j$ como la altura con respecto a la capa, para ello se calculan las alturas acumuladas) retornará el desplazamiento.

\subsectionanum{Validación de la metodología}

Para validar la metodología se realizaron dos pruebas, en una de ellas se prueba un sistema de 4 capas, en donde existe un gran contraste de impedancias (ello es que se utiliza una capa superficial muy blanda). En la otra prueba se utilizó un sistema de 5 capas todas idénticas. \\

El resultado esperado es que, para el primer caso, debe existir una amplificación notable del desplazamiento en superficie dado el fuerte contraste de impedancias. Por otro lado, en el segundo caso debe cumplirse que la onda debe ser contínua, sin cambio de pendiente en profundidad, ya que el caso es análogo al de una sola capa con las mismas propiedades.

\subsubsectionanum{Primer caso}

Se utilizó un sistema de 5 capas, con un perfil de velocidad de corte creciente en profundidad:

\begin{table}[H]
	\centering
	\caption{Sistema de capas inventado para este caso.}
	\begin{tabular}{ccccc}
		\hline
		\textbf{Capa} & \textbf{Vs (m/s)} & \boldmath{}\textbf{$\rho$ kN/m3}\unboldmath{} & \textbf{D} & \textbf{H (m)} \bigstrut\\
		\hline
		1     & 150   & 15    & 0.01  & 10 \bigstrut[t]\\
		2     & 700   & 17    & 0.03  & 5 \\
		3     & 750   & 17    & 0.02  & 15 \\
		4     & 900   & 20    & 0.01  & 10 \\
		-     & 1500  & 27    & 0.005 & - \bigstrut[b]\\
		\hline
	\end{tabular}
\end{table}

Obteniendo luego el siguiente resultado:

\insertimage{p2caso1impedancias}{width=10cm}{Registro $u(z,t)$ del sistema.}

Como es posible observar en la figura anterior existe un incremento importante en los desplazamientos en superficie fruto del fuerte contraste de impedancias, además, en roca, no se observa mayor cambio dado que las velocidades de corte son similares.

\newpage
\subsubsectionanum{Segundo caso}

Se modeló un sistema de 5 capas y una capa con una velocidad de corte $V_s$=250 m/s y una altura total de 50 metros. En ambos casos se obtuvo la misma solución, lo cual es consistente.

\begin{images}[\label{p2segundocaso}]{Registro de la onda en el segundo caso, tanto el sistema multicapa como el de una capa retorna el mismo resultado.}
	\addimage{p2caso25capa}{width=7cm}{Caso 5 capas.}
	\addimage{p2caso21capa}{width=7cm}{Caso una capa.}
\end{images}

Tal como es posible observar en la Figura \ref{p2segundocaso} se obtuvo la misma solución, mismo función de transferencia.